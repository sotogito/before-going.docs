처음부터 인덱스를 설계하기는 어려워서 기본 성능이 다  끝난 후에야 고민할 수 있엇다.

DB 인덱스는 = 추가 데이터 구조이다.
보통 B-Tree(균형 트리)나 Hash 구조르 사용한다.
테이블의 특정 컬럼을 기준으로 정렬된 목차를 따로 관리하는 셈이다.

인덱스를 설정하면 조회는 빨라지고 쓰기/수정/삭제는 느려지는데 

조회가 빨라지는 이유는
where절로 조회를 한다고 하면 인덱스가 없을 경우네 모든 row를 풀스캔 해야한다.
인덱스가 있을 경우는 균형트리 탐색으로 log_2(N)시간에 바로 찾아가고 수백만 검이어도 필요한 몇 건만 빠르게 읽어올 수있다. 즉 필요한 데이터 위치를 빠르게 찾아가는 목차 역할이라 조회가 빨라지는 것이다.

반면 왜 쓰기,수정,삭제는 느려질까?
데이블의 데이터가 바뀌면 인덱스도 같이 갱신해야하기 때문이다.
- INSERT
	- 새로운 row 추가시 pk 뿐만이 아니라 인덱스 컬럼값도 B-Tree에 삽입해야한다.
- UPDATE
	- 인덱스 걸린 컬럼 값을 바꾸게 될 경우에는 인덱스에 기존 위치 제거+새위치 삽입이 일어나게 된다. 즉 이것도 테이블 값마 바꾸는게 아니라 인덱스 구조도 재정렬이 필요하다.
- DELETE
	- row 삭제시 인덱스에서도 해당 키 삭제 제거를 해야하낟. 특히 대량 삭제는 인덱스 정리 비용이 커질 수 있다.

즉 인덱스를 설정하여 데이터 1변경에 테이블변경+인덱스변경까지 두번 작업이 필요하게 되는거다. 
그래서 느려진다.

이거를 매우 쉽게 이해해보자면 도서관을 생각하면 된다.
도서관에 새로 출간된 순으로 책을 쌓아두면 찾는것은 매우 어렵다. 반면에 새로운 책이 들어오거나 변경할 경우 그냥 책을 갈아 끼우거나 사장 최근 위치에 삽입만 해두면 된다.
반면에 인덱스를 설정을 비유하자면 목차 ㄱ-102와같은 구간을 나누는건데 이는 찾으려는 책을 더 빨리 찾을 수 있다. 철학에 "무경계" 라는 책을 찾고싶으면 철학 부분에 가서 ㅁ 구간에서 찾으면 된다. 반면에 새로운 책이 들어오면 어디에 삽입해야할지를 하나하나 계산해야하기 때문에 속도는 느려질수밖에 없다. 책을 버릴때도 비워진 칸을 매꿔야하기 때문에 사서는 일할 시간이 더 늘어날수밖에 없다

그래서 내가 찾을 책이 이 도서관의 꽤 많은 부분을 차지한다! 하면 목차를 나눌 필요는 없다. 풀스캔을 하는것이나, 목차에서 찾는것이나 비슷할것이기 때문이다.
반면에 내가 찾을 책이 15~20%구간이라면 목차를 추가해둔 구조에서 더 효율적이게 찾을 수 있을 것이다.


즉 인덱스는 "처리할 양"이 아니라 "조회할 양"으로 판단해야한다.

처음에는 00시, 01시마다 진행되는 미션 백업, 초기화, 삭제로직에 대량의 데이터를 처리해야하니 당연히 인덱스를태워야한다고 생각했는데, 이는 조회할 데이터 뿐만이 아니라 처리되어야할 데이터이다.

수정 삭제의 경우 결국은 row를 조회해야하고 처리해야하는데 인덱스를 처리하면 조회는 빠르지만 처리는 느려질 수잇다.
그래서 이 지점을 잘 생각해야할거같다

그래서 내가 생각한 것은

### Sceanrio
사용자당 가질 수 있는 시나리오의 개수는 알림당 20개로 Location 알림유형이 추가한다고 하더라도 40개이다. 미션처럼 쓰기, 수정, 삭제가 빈번한거는 아니지만 조회 캐시 처리도 해놨기 때문에 인덱스를 설정할 필요는 없다고 생각한다.
### Mission
미션은 Today 미션이 있기 때문에 쓰기, 삭제가 빈번하게 일어날 수 있다. 반면 미션 백업 로직이 있기 때문에 이는 인덱스 처리를 고려해볼만 하다.

하지만 이미 필요한 것들을 라 제약조건들로 인해 새로 추가하지 않아도 되며

그나마 고려해볼만한 것을이 아래와 같은데
1. use_date
2. sceanrio_id, use_date

- 시나리오마다 미션 20개
- 한달기간동안 스냅샷 백업
을 생각하면 1번을 해볼만 한 거 같다



하지만... 미션은 처리해야될 작업이 다양하기 때문에 지금은 조회 캐시도 처리해 두었겠다. 추후 추가하는게 맞는거 같다.